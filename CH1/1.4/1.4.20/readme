three binary searches so O(3logN)
